% Author :  Lionel du Peloux
% Contact : lionel.dupeloux@gmail
% Year : 2017

\chapter{Calculus of variations}
\label{chp=variation}

% --------------------------------------------------------------------------------------------
\section{Introduction}
% --------------------------------------------------------------------------------------------
In this appendix we drawback essential mathematical concepts for the calculus of variations \cite{Abraham2002}.
Recall how the notion of energy, gradients are extended to function spaces.



% --------------------------------------------------------------------------------------------
\section{Spaces}
% --------------------------------------------------------------------------------------------

\subsection{Normed space}
% --------------------------------------------------------------------------------------------
A \emph{normed space} $V(\mathbb{K})$ is a vector space $V$ over the scalar field $\mathbb{K}$ with a norm $\|.\|$.

A \emph{norm} is a map $\| . \|~: V \times V \longmapsto \mathbb{K}$ which satisfies~:
\begin{subequations}
\begin{align}
	&\forall x \in V, 							&& \|x\| = 0_\mathbb{K} \Rightarrow x = 0_V&&&\\
	&\forall x \in V, \forall \lambda \in \mathbb{K}, 	&& \|\lambda x\| = |\lambda| \,\|x\|&&&\\
	&\forall (x,y) \in V^2, 						&& \|x + y\| \leqslant \|x\| + \|y\|&&&
\end{align}
\end{subequations}


\subsection{Inner product space}
% --------------------------------------------------------------------------------------------
A \emph{inner product space} or \emph{pre-hilbert space} $E(\mathbb{K})$ is a vector space $E$ over the scalar field $\mathbb{K}$ with an inner product.

An \emph{inner product} is a map $\langle \,; \rangle~: E \times E \longmapsto \mathbb{K}$ which is bilinear, symmetric and positive-definite~:
\begin{subequations}
\begin{align}
	&\forall (x,y,z) \in E^3, \forall (\lambda,\mu) \in \mathbb{K}^2, 	&& \langle \lambda x\ + \mu y \,; z\rangle  = \lambda \langle  x \,; z\rangle + \mu \langle  y\,; z\rangle&&&\\
	&												&& \langle x \,; \lambda y + \mu z \rangle  = \lambda \langle  x\,; y\rangle + \mu \langle  x \,; z\rangle&&&\notag\\
	&\forall (x,y) \in E^2, 									&& \langle x\,; y\rangle = \langle y\,; x\rangle &&&\\
	&\forall x \in E, 										&& \langle x\,; x\rangle \geqslant 0_\mathbb{K} &&&\\
	&\forall x \in E, 										&& \langle x\,; x\rangle = 0_\mathbb{K} \Rightarrow x = 0_E &&&
\end{align}
\end{subequations}
Moreover, an inner product naturally induces a norm on $E$ defined by~:
\begin{align}
	\forall x \in E, \quad \|x\| = \sqrt{\langle x\,; x\rangle}
\end{align}
Thus, an inner product vector space is also naturally a normed vector space.

\subsection{Euclidean space}
% --------------------------------------------------------------------------------------------
An \emph{Euclidean space} $\mathcal{E}(\mathbb{R})$ is a finite-dimensional real vector space with an inner product.
Thus, distances and angles between vectors could be defined and measured regarding to the norm associated with the chosen inner product.

An Euclidean space is nothing but a finite-dimensional real pre-hilbert space.

\subsection{Banach space}
% --------------------------------------------------------------------------------------------

A \emph{Banach space} $\mathcal{B}(\mathbb{K})$ is a complete normed vector space, which means that it is a normed vector space in which every Cauchy sequence of $\mathcal{B}$ converges in $\mathcal{B}$ for the given norm.

Thus, a Banach space is a vector space with a metric that allows the computation of vector length and distance between vectors and is complete in the sense that a Cauchy sequence of vectors always converges to a well defined limit in that space.

\subsection{Hilbert space}
% --------------------------------------------------------------------------------------------

A \emph{Hilbert space} is an inner product vector space $\mathcal{H}(\mathbb{K})$ such that the natural norm induced by the inner product turns $\mathcal{H}$ into a complete metric space (i.e.\ every Cauchy sequence of $\mathcal{H}$ converges in $\mathcal{H}$).

The Hilbert space concept is a generalization of the Euclidean space concept.
In physics it's common to encounter Hilbert spaces as infinite-dimensional function spaces.

Hilbert spaces are Banach spaces, but the converse does not hold generally.

For example, $\mathcal{L}^2([a,b])$ is an infinite-dimensional Hilbert space with the canonical inner product $\langle f\,; g\rangle=\int_a^b fg$.

Note that $\mathcal{L}^2$ is the only Hilbert space among the $\mathcal{L}^p$ spaces.
% --------------------------------------------------------------------------------------------
\section{Derivative}
% --------------------------------------------------------------------------------------------

The well known notion of function derivative in $\mathbb{R}^\mathbb{R}$ can be extended to maps between Banach spaces.
This is useful in physics when formulating problems as variational problems, usually in terms of energy minimization. Indeed, energy is generally defined over a functional vector space and not simply over the real line.

In this case, the research of minimal values of a potential energy rests on the calculus of variations of the energy function compared to variations to other functions defining the problem (geometry, materials, boundary conditions, ...).

Mathematical concepts extended well-known notions of derivative, jacobian and hessian in Euclidean spaces (typically $\mathbb{R}^2$ or $\mathbb{R}^3$) for Banach functional spaces.

\subsection{Fréchet derivative}
% --------------------------------------------------------------------------------------------
\subsubsection{Differentiability}
Let $\mathcal{B}_V$ and $\mathcal{B}_W$ be two Banach spaces and $U \subset \mathcal{B}_V$ an open subset of $\mathcal{B}_V$.
Let $\fonction{f}{u}{f(u)}$ be a function of  $U^{\mathcal{B}_W}$.
$f$ is said to be \emph{Fréchet differentiable} at $u_0\in U$ if there exists a continious linear operator $\diff{f}{u_0} \in
\mathcal{L}(\mathcal{B}_V,{\mathcal{B}_W})$ such that~:
\begin{subequations}
\begin{align}
\lim_{h \to 0} \frac{f(u_0+h) - f(u_0)- \diffof{f}{u_0}{h}}{\|h\|} = 0
\end{align}
\text{Or, equivalently~:}
\begin{align}
	f(u_0+h) = f(u_0) + \diffof{f}{u_0}{h} + o(h) \quad , \quad
	\lim_{h \to 0} \frac{o(h)}{\|h\|} = 0
\end{align}
\end{subequations}

In the literature, it is common to found the following notations~: $df = \diffof{f}{u_0}{h} = \boldsymbol{D}f_{u_0}(h) = \boldsymbol{D}f(u_0,h)$ for the differential of $f$, which means nothing but $\boldsymbol{D}f(u_0)$ is linear regarding $h$. The dot denotes the evaluation of $\boldsymbol{D}f(u_0)$ at $h$. This notation can be ambiguous as far as the linearity of $\boldsymbol{D}f(u_0)$ in $h$ is denoted as a product which is not explicitly defined.

\subsubsection{Derivative}

If $f$ is Fréchet differentiable at $u_0 \in U$, the continous linear operator $\diff{f}{u_0} \in
\mathcal{L}(\mathcal{B}_V,{\mathcal{B}_W})$ is called the \emph{Fréchet derivative} of $f$ at $u_0$ and is also denoted~:
\begin{align}
	f'(u_0) = \diff{f}{u_0}
\end{align}
$f$ is said to be $\mathcal{C}^1$ in the sens of Fréchet if $f$ is Fréchet differentiable for all $u \in U$ and the function $\fonction{\boldsymbol{D}f}{u}{f'(u)}$ of $U^{\mathcal{L}(\mathcal{B}_V,{\mathcal{B}_W})}$ is continuous.

\subsubsection{Differential or total derivative}

$df = \diffof{f}{u_0}{h}$ is sometimes called the \emph{differential} or \emph{total derivative} of $f$ and represents the change in the function $f$ for a perturbation $h$ from $u_0$.

\subsubsection{Higer derivatives}

Because the differential of $f$ is a linear map from $\mathcal{B}_V$ to $\mathcal{L}(\mathcal{B}_V,{\mathcal{B}_W})$ it is possible to look for the differentiability of $\boldsymbol{D}f$. If it exists, it is denoted $\boldsymbol{D}^2f$ and maps $\mathcal{B}_V$ to $\mathcal{L}(\mathcal{B}_V,\mathcal{L}(\mathcal{B}_V,{\mathcal{B}_W}))$.

\subsection{Gâteaux derivative}
% --------------------------------------------------------------------------------------------
\subsubsection{Directional derivative}
Let $\mathcal{B}_V$ and $\mathcal{B}_W$ be two Banach spaces and $U \subset \mathcal{B}_V$ an open subset of $\mathcal{B}_V$.
Let $\fonction{f}{u}{f(u)}$ be a function of  $U^{\mathcal{B}_W}$.
$f$ is said to have a \emph{derivative in the direction} $h\in\mathcal{B}_V$ at $u_0\in U$ if~:
\begin{align}
\frac{d}{d\lambda}f(u_0+\lambda h)\Bigr|_{\lambda = 0} = \lim_{\lambda \to 0} \frac{f(u_0+\lambda h) - f(u_0)}{\lambda}
\end{align}
exists. This element of $\mathcal{B}_W$ is called the \emph{directional derivative} of $f$ in the direction $h$ at $u_0$.

\subsubsection{Differentiability}
Let $\mathcal{B}_V$ and $\mathcal{B}_W$ be two Banach spaces and $U \subset \mathcal{B}_V$ an open subset of $\mathcal{B}_V$.
Let $\fonction{f}{u}{f(u)}$ be a function of  $U^{\mathcal{B}_W}$.
$f$ is said to be \emph{Gâteaux differentiable} at $u_0\in U$ if there exists a continious linear operator $\diff{f}{u_0} \in
\mathcal{L}(\mathcal{B}_V,{\mathcal{B}_W})$ such that~:
\begin{subequations}
\begin{align}
\forall h \in \mathcal{U}, \quad\lim_{\lambda \to 0} \frac{f(u_0+\lambda h) - f(u_0)}{\lambda} = \frac{d}{d\lambda}f(u_0+\lambda h)\Bigr|_{\lambda = 0} = \diffof{f}{u_0}{h}
\end{align}
Or, equivalently~:
\begin{align}
	\forall h \in \mathcal{U}, \quad f(u+\lambda h) = f(u) + \lambda \diffof{f}{u_0}{h} + o(\lambda)
	\quad , \quad \lim_{\lambda \to 0} \frac{o(\lambda)}{\lambda} = 0
\end{align}
\end{subequations}

In other words, it means that all the directional derivatives of $f$ exist at $u_0$.

\subsubsection{Derivative}
If $f$ is Gâteaux differentiable at $u_0 \in U$, the continous linear operator $\diff{f}{u_0} \in
\mathcal{L}(\mathcal{B}_V,{\mathcal{B}_W})$ is called the \emph{Gâteaux derivative} of $f$ at $u_0$ and is also denoted~:
\begin{align}
	f'(u_0) = \diff{f}{u_0}
\end{align}
$f$ is said to be $\mathcal{C}^1$ in the sens of Gâteaux if $f$ is Gâteaux differentiable for all $u \in U$ and the function $\fonction{\boldsymbol{D}f}{u}{f'(u)}$ of $U^{\mathcal{L}(\mathcal{B}_V,{\mathcal{B}_W})}$ is continuous.

The Gâteaux derivative is a weaker form of derivative than the Fréchet derivative. If $f$ is Fréchet differentiable, then it is also Gâteaux differentiable and its Fréchet and Gâteaux derivatives agree, but the converse does not hold generally.

\subsection{Useful properties}

Let $\mathcal{B}_V$, $\mathcal{B}_W$ and $\mathcal{B}_Z$ be three Banach spaces.
Let $f,g~: \mathcal{B}_V \longmapsto \mathcal{B}_W$ and $h~: \mathcal{B}_W \longmapsto \mathcal{B}_Z$ be three Gâteaux differentiable functions. Then, the following useful properties holds~:
\begin{align}
	&\diff{(f+g)}{u} = \diff{f}{u} + \diff{g}{u}\\
	&\diff{(f \circ h)}{u} = \diff{h}{f(u)}\circ\diff{f}{u} = \diff{h}{f(u)}\cdot\diff{f}{u}
\end{align}
Recall that the composition of $\diff{h}{f(u)}$ with $\diff{f}{u}$ means \guil{$\diff{h}{f(u)}$ applied to $\diff{f}{u}$} and is also denoted by $\cdot$ as explained previously.

\subsection{Partial derivative}

Following~\cite{Abraham2002} the main results on partial derivatives of two-variables functions are presented here. They are generalizable to n-variables functions.

\subsubsection{Definition}

Let $\mathcal{B}_{V_1}$, $\mathcal{B}_{V_2}$ and $\mathcal{B}_W$ be three Banach spaces and $U \subset \mathcal{B}_{V_1}\oplus\mathcal{B}_{V_2}$ an open subset of $\mathcal{B}_{V_1}\oplus\mathcal{B}_{V_2}$.
Let $\fonction{f}{u}{f(u)}$ be a function of  $U^{\mathcal{B}_W}$.
Let $u_0 = (u_{01},u_{02}) \in U$.
If the derivatives of the following functions exist~:
\begin{equation}
	\fonctionL{f_1}{\mathcal{B}_{V_1}}{\mathcal{B}_{W}}{u_1}{f(u_1,u_{02})}
	\quad , \quad
	\fonctionL{f_2}{\mathcal{B}_{V_2}}{\mathcal{B}_{W}}{u_2}{f(u_{01},u_{2})}
\end{equation}
they are called \emph{partial derivatives} of $f$ at $u_0$ and are denoted $\pdiff{1}{f}{u_0} \in
\mathcal{L}(\mathcal{B}_{V_1},{\mathcal{B}_W})$ and $\pdiff{2}{f}{u_0} \in
\mathcal{L}(\mathcal{B}_{V_2},{\mathcal{B}_W})$.

\subsubsection{Differentiability}

Let $\mathcal{B}_{V_1}$, $\mathcal{B}_{V_2}$ and $\mathcal{B}_W$ be three Banach spaces and $U \subset \mathcal{B}_{V_1}\oplus\mathcal{B}_{V_2}$ an open subset of $\mathcal{B}_{V_1}\oplus\mathcal{B}_{V_2}$.
Let $\fonction{f}{u}{f(u)}$ be a function of  $U^{\mathcal{B}_W}$.
If $f$ is differentiable, then the partial derivatives exist and satisfy for all $h = (h_1,h_2) \in \mathcal{B}_{V_1}\oplus\mathcal{B}_{V_2}$~:
\begin{align}
	&\pdiffof{1}{f}{u}{h_1} = \diffof{f}{u}{(h_1,0)} \\
	&\pdiffof{2}{f}{u}{h_2} = \diffof{f}{u}{(0,h_2)} \\
	&\diffof{f}{u}{(h_1,h_2)} = \pdiffof{1}{f}{u}{h_1} + \pdiffof{2}{f}{u}{h_2}
\end{align}

\section{Gradient vector}

Let $\mathcal{H}$ be a Hilbert space with the inner product denoted $\scalar{}{}$. Let $U \subset \mathcal{H}$ an open subset of $\mathcal{H}$.
Let $\fonction{F}{u}{F(u)}$ be a scalar function of  $U^{\mathbb{R}}$.
The \emph{gradient} of $F$ is the map $\fonction{\grad{F}}{x}{(\grad{F})(x)}$ of $U^{\mathcal{H}}$ such that~:
\begin{equation}
	\forall h \in \mathcal{H}, \quad  \scalar{(\grad{F})(x)}{h} = \diffof{F}{x}{h}
\end{equation}
Note that the gradient vector depends on the chosen inner product.
For $\mathcal{H} = \mathbb{R}^{n}$ with the canonical inner product, one can recall the usual definition of the gradient vector and the corresponding linear approximation of $F$~:
\begin{equation}
	\mat{F}_{x+h} = \mat{F}_{x} + (\grad{F})_{x}^T H + \mat{o}(H)
	\quad , \quad \grad{F}_{x} = \left[\begin{array}{c}\frac{\partial F}{\partial x_1} \\ \vdots \\ \frac{\partial F}{\partial x_n}\end{array}\right] \in \mathbb{R}^n
\end{equation}
Recall that the canonical inner product on $\mathbb{R}^{n}$ is such that $\scalar{x}{y} = X^{T}Y$ in a column vector representation. In this case it is common to denote $\grad{F} = \nabla{F}$.

For function spaces the usual definition of the gradient can be extended. For instance if $F$ is a scalar function on $\mathcal{L}^2$, the gradient of $F$ is the unique function (if it exists) from $\mathcal{L}^2$ which satisfies~:
\begin{equation}
	\forall h \in \mathcal{L}^2, \quad \diffof{F}{x}{h} = \scalar{(\grad{F})(x)}{h} = \int (\grad{F})h
\end{equation}
In this case it is common to denote $\grad{F} = \frac{\delta F}{\delta x}$. The gradient is also known as the \emph{functional derivative}. The existence and unicity of $\grad{F}$ is ensured by the \emph{Riesz representation theorem}.

\section{Jacobian matrix}
Let $f$ be a differentiable function from $\mathbb{R}^n$ to $\mathbb{R}^m$. The \emph{differential} or \emph{total derivative} of such a fonction is a linear application from $\mathbb{R}^n$ to $\mathbb{R}^m$ which could be represented with the following matrix called the \emph{jacobian matrix}~:
\begin{align}
	&\diff{f}{x} = \mat{J}_x = \frac{df}{dx} =
	\begin{bmatrix}
		\frac{\partial f}{\partial x_1}&\cdots&\frac{\partial f}{\partial x_n}
	\end{bmatrix}=
	\begin{bmatrix}
		\frac{\partial f_1}{\partial x_1} & \cdots & \frac{\partial f_1}{\partial x_n} \\
		\vdots & \ddots & \vdots \\
		\frac{\partial f_m}{\partial x_1} & \cdots & \frac{\partial f_m}{\partial x_n}
	\end{bmatrix}
	\in\mathcal{M}_{m,n}(\mathbb{R})
\end{align}
Thus, with the matrix notation, the Taylor expansion takes the following form~:
\begin{align}
	&\mat{F}_{x+h} = \mat{F}_{x} +  \boldsymbol{J}_x H + \mat{o}(H)
\end{align}
In the cas $m=1$, the jacobian matrix of the functional $F$ is nothing but the gradient vector transpose itself~:
\begin{align}
	\diff{F}{x} = \mat{J}_x = \frac{dF}{dx} =
	\begin{bmatrix}
		\frac{\partial F}{\partial x_1}& \cdots&\frac{\partial F}{\partial x_n}
	\end{bmatrix} = \nabla F^T
\end{align}

\section{Hessian}
Let $F$ be a differentiable scalar function from $\mathbb{R}^n$ to $\mathbb{R}$. The second order differential of such a fonction is a linear application from $\mathbb{R}^n$ to $\mathbb{R}^n$ which could be represented with the following matrix called the \emph{hessian matrix}~:
\begin{equation}
\renewcommand\arraystretch{1.5}
\begin{aligned}
	&\boldsymbol{D}^{2}F(x) = \mat{H}_{x} = \frac{d^2F}{dx}(x) =
	\begin{bmatrix}
		\frac{\partial F^2_1}{\partial x_1^2} & \frac{\partial F^2_1}{\partial x_1\partial x_2} &\cdots & \frac{\partial F^2_1}{\partial x_1\partial x_n} \\
		\frac{\partial F^2_1}{\partial x_2\partial x_1} & \frac{\partial F^2_1}{\partial x_2^2} &\cdots & \frac{\partial F^2_1}{\partial x_2\partial x_n} \\
		\vdots & &\ddots & \vdots \\
		\frac{\partial F^2_p}{\partial x_n\partial x_1} & \frac{\partial F^2_p}{\partial x_n\partial x_2}&\cdots & \frac{\partial F^2_p}{\partial x_n^2}
	\end{bmatrix}
	\in\mathcal{M}_{n,n}(\mathbb{R})
\end{aligned}
\end{equation}
Thus, with the matrix notation, the Taylor expansion takes the following form~:
\begin{align}
	\mat{F}_{x+h} = \mat{F}_{x} +  \mat{J}_{x} H + \tfrac{1}{2}H^T \mat{H}_{x} H + \mat{o}(H)
\end{align}


\section{Functional}
% --------------------------------------------------------------------------------------------
A \emph{functional} is a map from a vector space $E(\mathbb{K})$ into its underlying scalar field $\mathbb{K}$. Here $\mathcal{E}_p[\boldsymbol{x},\theta]$ is a functional depending over $\boldsymbol{x}$ and $\theta$.
